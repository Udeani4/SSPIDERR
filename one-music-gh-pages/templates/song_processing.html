<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="description" content="">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- The above 4 meta tags *must* come first in the head; any other head content must come *after* these tags -->

    <!-- Title -->
    <title>SSPIDERR</title>

    <!-- Favicon -->
    <link rel="icon" href="{{ url_for('static', filename='img/core-img/favicon.ico') }}">

    <!-- Stylesheet -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">

    <!-- dropzone scripts-->
    <script src="https://unpkg.com/dropzone@5/dist/min/dropzone.min.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/dropzone@5/dist/min/dropzone.min.css" type="text/css" />
<!--    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">-->
    <style>

    .status-container {
      position: relative;
      z-index: 1;
    }

    .status-container {
      display: grid;
      grid-template-columns: repeat(2, 200px);
      gap: 2rem;
    }

    .status-circle {
      width: 200px;
      height: 200px;
      border-radius: 50%;
      background: white;
      box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
      display: flex;
      align-items: center;
      justify-content: center;
      text-align: center;
      font-weight: bold;
      cursor: pointer;
      position: relative;
      overflow: hidden;
    }

    .status-circle h6 {
      animation: flashText 2s infinite;
    }

    @keyframes flashText {
      0% { opacity: 0; transform: scale(0.9); }
      50% { opacity: 1; transform: scale(1.05); }
      100% { opacity: 0; transform: scale(0.9); }
    }

    /* Modal styling */
    .modal {
      display: none;
      position: fixed;
      z-index: 999;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.6);
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .modal-content {
      background: #fff;
      padding: 20px;
      width: 400px;
      border-radius: 12px;
      box-shadow: 0 8px 30px rgba(0,0,0,0.25);
    }

    .modal-content h2 {
      margin-top: 0;
    }

    .close-btn {
      float: right;
      cursor: pointer;
      font-size: 20px;
      color: red;
    }

    
  </style>
</head>

<body>
    <!-- Preloader -->
    <div class="preloader d-flex align-items-center justify-content-center">
        <div class="lds-ellipsis">
            <div></div>
            <div></div>
            <div></div>
            <div></div>
        </div>
    </div>

    <!-- ##### Header Area Start ##### -->
    <header class="header-area">
        <!-- Navbar Area -->
        <div class="oneMusic-main-menu">
            <div class="classy-nav-container breakpoint-off">
                <div class="container">
                    <!-- Menu -->
                    <nav class="classy-navbar justify-content-between" id="oneMusicNav">

                        <!-- Nav brand -->
                        <a href="{{ url_for('home') }}" class="nav-brand"><img src="{{ url_for('static', filename= 'img/core-img/logo.png') }}" alt=""></a>

                        <!-- Navbar Toggler -->
                        <div class="classy-navbar-toggler">
                            <span class="navbarToggler"><span></span><span></span><span></span></span>
                        </div>

                        <!-- Menu -->
                        <div class="classy-menu">

                            <!-- Close Button -->
                            <div class="classycloseIcon">
                                <div class="cross-wrap"><span class="top"></span><span class="bottom"></span></div>
                            </div>

                            <!-- Nav Start -->
                            <div class="classynav">
                                <ul>
                                    <li><a href="{{ url_for('home') }}">Home</a></li>
                                    {% if current_user.is_authenticated: %}
                                        <li><a href="{{ url_for('playlist') }}">playlists</a></li>
                                    {% endif %}
                                    <li><a href="#">Pages</a>
                                        <ul class="dropdown">
                                            <li><a href="{{ url_for('home') }}">Home</a></li>
                                            {% if current_user.is_authenticated: %}
                                                <li><a href="{{ url_for('playlist') }}">Playlists</a></li>
                                            {% endif %}
                                            <li><a href="{{ url_for('about_us') }}">About</a></li>
                                            <li><a href="{{ url_for('news_blog') }}">News</a></li>
                                            <li><a href="{{ url_for('contact_us') }}">Contact</a></li>
                                            <li><a href="{{ url_for('elements') }}">Elements</a></li>
                                            {% if not current_user.is_authenticated: %}
                                                <li><a href="{{ url_for('login_page') }}">Login</a></li>
                                            {% else: %}
                                                <li><a href="{{ url_for('logout') }}">Logout</a></li>
                                            {% endif %}
                                            <li><a href="#">Dropdown</a>
                                                <ul class="dropdown">
                                                    <li><a href="{{ url_for('file_upload') }}">Upload Test</a></li>
                                                    <li><a href="#">Even Dropdown</a></li>
                                                    <li><a href="#">Even Dropdown</a></li>
                                                    <li><a href="#">Even Dropdown</a>
                                                        <ul class="dropdown">
                                                            <li><a href="#">Deeply Dropdown</a></li>
                                                            <li><a href="#">Deeply Dropdown</a></li>
                                                            <li><a href="#">Deeply Dropdown</a></li>
                                                            <li><a href="#">Deeply Dropdown</a></li>
                                                            <li><a href="#">Deeply Dropdown</a></li>
                                                        </ul>
                                                    </li>
                                                    <li><a href="#">Even Dropdown</a></li>
                                                </ul>
                                            </li>
                                        </ul>
                                    </li>
                                    <li><a href="{{ url_for('about_us') }}">About</a></li>
                                    <li><a href="{{ url_for('news_blog') }}">News</a></li>
                                    <li><a href="{{ url_for('contact_us') }}">Contact</a></li>
                                </ul>

                                <!-- Login/Register & Cart Button -->
                                <div class="login-register-cart-button d-flex align-items-center">

                                    {% if not current_user.is_authenticated: %}
                                        <!-- Login/Register -->
                                        <div class="login-register-btn mr-50">
                                            <a href="{{ url_for('login_page') }}" id="loginBtn">Login / Register</a>
                                        </div>
                                    {% else: %}
                                        <!--Logout-->
                                        <div class="login-register-btn mr-50">
                                            <a href="{{ url_for('logout') }}" id="logoutBtn">Logout</a>
                                        </div>
                                    {% endif %}

                                    <!-- Cart Button -->
                                    <div class="cart-btn">
                                        <p><span class="icon-shopping-cart"></span> <span class="quantity">1</span></p>
                                    </div>
                                </div>
                            </div>
                            <!-- Nav End -->

                        </div>
                    </nav>
                </div>
            </div>
        </div>
    </header>
    <!-- ##### Header Area End ##### -->
    <div class="status-container">
      <div class="status-circle" onclick="openModal('recognised')">
<!--        <span>Recognised</span>-->
        <h6 id="recognised-text"></h6>
      </div>
      <div class="status-circle" onclick="openModal('not-recognised')">
<!--        <span>Not Recognised</span>-->
        <h6 id="not-recognised-text"></h6>
      </div>
      <div class="status-circle" onclick="openModal('sent')">
<!--        <span>Sent ✅</span>-->
        <h6 id="sent-text"></h6>
      </div>
      <div class="status-circle" onclick="openModal('failed')">
<!--        <span>Failed ❌</span>-->
        <h6 id="failed-text"></h6>
      </div>
    </div>

      <!-- Modal -->
      <div id="statusModal" class="modal">
        <div class="modal-content">
          <span class="close-btn" onclick="closeModal()">&times;</span>
          <h2 id="modal-title"></h2>
          <ul id="modal-list"></ul>
        </div>
      </div>



  {% include "footer.html" %}

    <!-- ##### All Javascript Script ##### -->
    <!-- jQuery-2.2.4 js -->
    <!-- jQuery js -->
    <script src="{{ url_for('static', filename='js/jquery/jquery-2.2.4.min.js') }}"></script>
    <!-- Popper js -->
    <script src="{{ url_for('static', filename='js/bootstrap/popper.min.js') }}"></script>
    <!-- Bootstrap js -->
    <script src="{{ url_for('static', filename='js/bootstrap/bootstrap.min.js') }}"></script>
    <!-- All Plugins js -->
    <script src="{{ url_for('static', filename='js/plugins/plugins.js') }}"></script>
    <!-- Active js -->
    <script src="{{ url_for('static', filename='js/active.js') }}"></script>


  <script>
    const data = {
      recognised: ["Song A", "Song B", "Song C"],
      "not-recognised": ["Song X", "Song Y"],
      sent: ["Song A → Chill Playlist", "Song B → Work Playlist"],
      failed: ["Song Z → Party Playlist"]
    };


    function openModal(type) {
      document.getElementById("statusModal").style.display = "flex";
      document.getElementById("modal-title").innerText = type.replace("-", " ").toUpperCase();

      const list = document.getElementById("modal-list");
      list.innerHTML = "";
      data[type].forEach(item => {
        let li = document.createElement("li");
        li.textContent = item;
        list.appendChild(li);
      });
    }

    function closeModal() {
      document.getElementById("statusModal").style.display = "none";
    }

     document.addEventListener("DOMContentLoaded" , () => closeModal() )

  </script>

  <script>
      // Reusable function
      function updateCircle(type, message) {
        const el = document.getElementById(`${type}-text`);
        if (el) {
          el.textContent = message;   // overwrite with latest
          // If you want multiple lines instead, uncomment this:
          // el.innerHTML += `<p>${message}</p>`;
        }
      }

      // Create EventSource connection
      const playlistId = "{{ playlist_id }}";  // Jinja injects it
      const source = new EventSource(`/song-processing-stream/${playlistId}`);

      // Recognised
      source.addEventListener("recognised", (event) => {
        const data = JSON.parse(event.data);
        updateCircle("recognised", data.message);
      });

      // Not recognised
      source.addEventListener("not_recognised", (event) => {
        const data = JSON.parse(event.data);
        updateCircle("not-recognised", data.message);
      });

      // Sent
      source.addEventListener("sent", (event) => {
        const data = JSON.parse(event.data);
        updateCircle("sent", data.message);
      });

      // Failed
      source.addEventListener("failed", (event) => {
        const data = JSON.parse(event.data);
        updateCircle("failed", data.message);
      });
  </script>

</body>
</html>
